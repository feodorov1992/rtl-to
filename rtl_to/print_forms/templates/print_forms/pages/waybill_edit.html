{% block 'inner_content' %}
<div>
    <h2>Изменение ТН {{ form.instance.waybill_number }}</h2>
</div>
<form id="waybill_data_edit_form" method="post">
    {% csrf_token %}

    <table class="form_table">
        {{ form.as_my_style }}
    </table>
    <button type="submit">Сохранить</button>
    <span class="link_styled_span" onclick="clicked_sub_link.click()">Отмена</span>
</form>
{% endblock %}

<script>
    $('#waybill_data_edit_form button[type=submit]').click(function(e){
        e.preventDefault()
        url = '{{ request.path }}'
        $.ajax({
            url: url,
            type: 'POST',
            data: $('#waybill_data_edit_form').serialize(),
            success: function(data){
                content = $(data)
                if (content.find('#id_waybill_number').length == 0) {
                    clicked_sub_link.click()
                } else {
                    $('#subModalQuickView').html(null);
                    $('#subModalQuickView').append(content);
                    $('#subModalWindow').css('display', 'flex');
                    $('html, body').css({
                        overflow: 'hidden',
                        height: '100%'
                    });
                }
            }
        });
    })
</script>